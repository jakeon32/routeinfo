## **🚌 노선 및 스케줄 관리 시스템 개발 요구사항 정의서 (Version 1.2)**

---

## 

## **1\. 정거장 및 승하차장 관리 (Station & Stop Management) 📍**

### **1.1. 기능 요구사항**

* **정거장 (Station):** 상위 지점 개념으로 정거장명 등록/수정/삭제. 하위 승하차장 연결 관리.  
* **승하차장 (Stop):** 실제 탑승 장소 정보 등록/수정/삭제.  
* **위치 정보:** **지도 API**를 이용해 위치를 등록하며, **위도($\\text{Latitude}$)/경도($\\text{Longitude}$)** 좌표를 저장.  
* **주 승하차장 설정:** 하나의 정거장을 대표하는 **주 승하차장**을 지정 가능.  
* **사진 정보:** 실제 탑승 장소의 사진 이미지 업로드 및 등록.

### **1.2. 데이터 모델**

#### **TABLE: Stations (정거장 정보)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| station\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 정거장 고유 ID |
| name | VARCHAR(100) | $\\text{NOT NULL}$ | 정거장명 |
| primary\_stop\_id | INT | $\\text{FK}$ $\\rightarrow$ Stops | **대표(주) 승하차장 ID** |

#### 

#### 

#### 

#### 

#### 

#### 

#### 

#### **TABLE: Stops (승하차장 정보)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| stop\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 승하차장 고유 ID |
| station\_id | INT | $\\text{FK}$ $\\rightarrow$ Stations | 소속 정거장 ID |
| name | VARCHAR(100) | $\\text{NOT NULL}$ | 승하차장명 |
| address | VARCHAR(255) |  | 주소 정보 |
| latitude | DECIMAL($10,7$) | $\\text{NOT NULL}$ | 위치 **위도** 좌표 |
| longitude | DECIMAL($10,7$) | $\\text{NOT NULL}$ | 위치 **경도** 좌표 |
| description | TEXT |  | 설명 정보 |
| photo\_url | VARCHAR(255) |  | 업로드된 사진 URL |

---

## 

## **2\. 노선 정보 및 속성 관리 (Route Management) 🛣️**

### **2.1. 기능 요구사항**

* **노선 기본 정보:** 노선명, 그룹명 (선택), 노선 속성 설정.  
* **노선 구성:** 등록된 정거장 및 하위 승하차장을 순서대로 등록/순서 변경/삭제.  
* **시간/거리:** 각 정거장별 **이전 정거장으로부터의 소요시간/거리** 설정.  
* **정류장 속성:** 각 정거장의 목적을 다음 중 하나로 설정: **승차 전용** (ON), **하차 전용** (OFF), **승하차 가능** (ON\\\_OFF), **참조용** (REF).  
* **블락 기능:** 정거장의 임시 사용 중지 (**활성/비활성** 상태) 설정.  
* **노선 속성 관리:** 별도 속성 테이블 관리. **사용 중인 속성**은 **삭제 불가**하며, **비활성** 처리하여 신규 사용만 제한. 수정 시 모든 사용 노선에 일괄 반영.

### **2.2. 데이터 모델**

#### **TABLE: Routes (노선 정보)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| route\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 노선 고유 ID |
| name | VARCHAR(100) | $\\text{NOT NULL}$ | 노선명 |
| group\_name | VARCHAR(100) |  | 그룹명 (선택값) |

#### 

#### **TABLE: Route\_Attributes (노선 속성 마스터)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| attr\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 속성 고유 ID |
| name | VARCHAR(50) | $\\text{NOT NULL}$ | 속성명 (ex: 입국, 출근) |
| is\_active | BOOLEAN | $\\text{DEFAULT TRUE}$ | 사용 상태 (활성/비활성) |
| is\_display | BOOLEAN | $\\text{DEFAULT TRUE}$ | 사용자 페이지 노출 여부 |

#### 

#### 

#### 

#### **TABLE: Route\_RouteAttributes (노선-속성 연결)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| route\_id | INT | $\\text{PK}$, $\\text{FK}$ $\\rightarrow$ Routes | 노선 ID |
| attr\_id | INT | $\\text{PK}$, $\\text{FK}$ $\\rightarrow$ Route\_Attributes | 속성 ID |

#### 

#### **TABLE: Route\_Stops (노선 구성 정보)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| route\_stop\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 노선 구성 순번 ID |
| route\_id | INT | $\\text{FK}$ $\\rightarrow$ Routes | 노선 ID |
| stop\_id | INT | $\\text{FK}$ $\\rightarrow$ Stops | 해당 노선에서 선택된 승하차장 ID |
| sequence | INT | $\\text{NOT NULL}$ | 노선 내 정거장 순서 |
| travel\_time\_min | INT |  | 이전 정거장으로부터 소요 시간 (분) |
| distance\_m | INT |  | 이전 정거장으로부터 소요 거리 (미터) |
| **stop\_purpose** | **ENUM** | $\\text{NOT NULL}$ | **정류장 속성** (ON, OFF, ON\\\_OFF, REF) |
| is\_blocked | BOOLEAN | $\\text{DEFAULT FALSE}$ | 임시 사용 중지 (블락) 여부 |

---

## 

## **3\. 스케줄 관리 (Schedule Management) 🗓️**

### **3.1. 기능 요구사항**

* **스케줄 유형:** **정기(Recurring)** 또는 **단발성(One-off)** 유형 지정.  
* **기간 설정:** 스케줄이 유효한 시작일 및 종료일 설정.  
* **회차 설정:** 회차 갯수 설정, 회차별 **기점 출발 시간** 설정.  
* **시간 자동 계산:** 출발 시간 및 노선 구성 소요시간을 바탕으로 경유지 및 **종점 예상 도착 시간** 자동 계산 및 저장.  
* **스케줄 리스트:** 생성, 수정, 삭제, 리스트 조회 (조회 옵션 포함).

### **3.2. 데이터 모델**

#### **TABLE: Schedules (스케줄 정보)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| schedule\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 스케줄 고유 ID |
| route\_id | INT | $\\text{FK}$ $\\rightarrow$ Routes | 적용 노선 ID |
| start\_date | DATE | $\\text{NOT NULL}$ | 운영 시작일 |
| end\_date | DATE | $\\text{NOT NULL}$ | 운영 종료일 |
| schedule\_type | ENUM | $\\text{NOT NULL}$ | **스케줄 유형** (REGULAR, ONCE) |

#### 

#### 

#### **TABLE: Schedule\_Details (회차별 시간 정보)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| detail\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 회차 상세 ID |
| schedule\_id | INT | $\\text{FK}$ $\\rightarrow$ Schedules | 스케줄 ID |
| trip\_number | INT | $\\text{NOT NULL}$ | 회차 번호 |
| departure\_time | TIME | $\\text{NOT NULL}$ | **기점 출발 시간** |
| arrival\_time | TIME |  | **종점 예상 도착 시간** (자동 계산) |

---

## 

## **4\. 노선 정보 사용자 페이지 관리 및 구성 (User Page) 🌐**

### **4.1. 관리 기능 요구사항**

* **페이지 생성/관리:** 사용자 페이지 생성, 수정, 삭제.  
* **URL 설정:** 페이지 접근을 위한 **고유 URL/슬러그** 설정.  
* **노선/그룹 선택:** 페이지에 노출할 노선 **그룹** 및 **노선 목록** 설정.  
* **구분 속성:** 노선 구분 탭에 사용할 **노선 속성** 선택.  
* **개별 정보:** **HTML 에디터**를 이용한 추가 정보 입력 기능.  
* **노선 목록 순서:** 노선 목록 노출 순서는 시스템 내부 정렬 기준(등록일, ID 등)에 따름. **관리자 설정 순서 기능은 미포함.**

### **4.2. 사용자 페이지 구성 요구사항**

| 표시 항목 | 상세 내용 |
| :---- | :---- |
| **페이지 타이틀** | 설정된 타이틀 또는 선택된 그룹명/노선명 표시. |
| **노선 구분(탭)** | 선택된 **구분 속성**별 탭 생성. |
| **노선 목록** | 선택된 노선 목록 표시 (버튼 형태, 첫 노선 기본 선택). |
| **노선도** | 선택 노선의 경로 그래픽 시각화 (**PC:** 가로, **Mobile:** 세로). |
| **스케줄** | 운영 기간 및 회차별 **출발/도착 시간표** 표시. |
| **탑승 장소** | 노선 순서대로 승하차장명, **설명 텍스트**, **사진 정보** 표시. |

### 

### **4.3. 데이터 모델**

#### **TABLE: User\_Pages (사용자 페이지 관리)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| page\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 페이지 고유 ID |
| title | VARCHAR(100) | $\\text{NOT NULL}$ | 페이지 타이틀 값 |
| slug | VARCHAR(100) | $\\text{UNIQUE}$, $\\text{NOT NULL}$ | 페이지 **고유 URL/슬러그** |
| selected\_group | VARCHAR(100) |  | 선택된 그룹명 (그룹 전체 선택 시) |
| attribute\_for\_tab\_id | INT | $\\text{FK}$ $\\rightarrow$ Route\_Attributes | 노선 구분(탭)으로 사용할 속성 ID |
| custom\_html | TEXT |  | HTML 에디터로 입력된 추가 정보 |

#### 

#### **TABLE: UserPage\_Routes (페이지-노선 연결)**

| 필드명 | 데이터 타입 | 제약 조건 | 설명 |
| :---- | :---- | :---- | :---- |
| page\_route\_id | INT | $\\text{PK}$, $\\text{Auto Increment}$ | 연결 고유 ID |
| page\_id | INT | $\\text{FK}$ $\\rightarrow$ User\_Pages | 페이지 ID |
| route\_id | INT | $\\text{FK}$ $\\rightarrow$ Routes | 페이지에 노출할 노선 ID |

---

